<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ysd.dao.hpy.StudentsMapper">
		<resultMap type="com.ysd.entity.hpy.CustomerStudents" id="studentMap">
			<id column="Id" property="Id"></id>
			<result column="Name" property="Name"/>
			<result column="Age" property="Age"/>
			<result column="Sex" property="Sex"/>
			<result column="Phone" property="Phone"/>
			<result column="StuStatus" property="StuStatus"/>
			<result column="SourceUrl" property="SourceUrl"/>
			<result column="PerState" property="PerState"/>
			<result column="MsgSource" property="MsgSource"/>
			<result column="SourceKeyWord" property="SourceKeyWord"/>
			<result column="Address" property="Address"/>
			<result column="NetPusherId" property="NetPusherId"/>
			<result column="AskerId" property="AskerId"/>
			<result column="QQ" property="QQ"/>
			<result column="WeiXin" property="WeiXin"/>
			<result column="Content" property="Content"/>
			<result column="CreateTime" property="CreateTime"/>
			<result column="LearnForward" property="LearnForward"/>
			<result column="IsValid" property="IsValid"/>
			<result column="Record" property="Record"/>
			<result column="IsReturnVist" property="IsReturnVist"/>
			<result column="FirstVisitTime" property="FirstVisitTime"/>
			<result column="IsHome" property="IsHome"/>
			<result column="HomeTime" property="HomeTime"/>
			<result column="LostValid" property="LostValid"/>
			<result column="IsPay" property="IsPay"/>
			<result column="PayTime" property="PayTime"/>
			<result column="Money" property="Money"/>
			<result column="IsReturnMoney" property="IsReturnMoney"/>
			<result column="IsInClass" property="IsInClass"/>
			<result column="InClassTime" property="InClassTime"/>
			<result column="InClassContent" property="InClassContent"/>
			<result column="AskerContent" property="AskerContent"/>
			<result column="IsDel" property="IsDel"/>
			<result column="FromPart" property="FromPart"/>
			<result column="StuConcern" property="StuConcern"/>
			<result column="IsBaoBei" property="IsBaoBei"/>
			<result column="ZiXunName" property="ZiXunName"/>
			<result column="CreateUser" property="CreateUser"/>
			<result column="ReturnMoneyReason" property="ReturnMoneyReason"/>
			<result column="PreMoney" property="PreMoney"/>
			<result column="PreMoneyTime" property="PreMoneyTime"/>
			<result column="askersId" property="askers.askersId"/>
			<result column="askersName" property="askers.askersName"/>
			<result column="CheckState" property="askers.CheckState"/>
			<result column="CheckInTime" property="askers.CheckInTime"/>
			<result column="ChangeState" property="askers.ChangeState"/>
			<result column="Weight" property="askers.Weight"/>
			<result column="RoleName" property="askers.RoleName"/>
			<result column="BakContent" property="askers.BakContent"/>
			<result column="Id" property="netfollows.Id"/>
			<result column="StudentId" property="netfollows.StudentId"/>
			<result column="StudentName" property="netfollows.StudentName"/>
			<result column="FollowTime" property="netfollows.FollowTime"/>
			<result column="NextFollowTime" property="netfollows.NextFollowTime"/>
			<result column="Content" property="netfollows.Content"/>
			<result column="UserId" property="netfollows.UserId"/>
			<result column="FollowType" property="netfollows.FollowType"/>
			<result column="CreateTime" property="netfollows.CreateTime"/>
			<result column="FollowState" property="netfollows.FollowState"/>
		</resultMap>
		
		
		<select id="selectStu" parameterType="com.ysd.entity.hpy.Fenye" resultMap="studentMap">
			SELECT s.*,a.* from students s,askers a
		<where>
			<if test="Name !=null and Name!=''">
			  and	Name like "%"#{Name}"%"
			</if>
			<if test="Phone !=null and Phone!='' ">
				and Phone like "%"#{Phone}"%"
			</if>
			<if test="IsPay !=null and IsPay !='' ">
				and IsPay like "%"#{IsPay}"%"
			</if>
			<if test="QQ !=null and QQ !='' ">
				and QQ like "%"#{QQ}"%"
			</if>
			<if test="IsReturnVist !=null and IsReturnVist !='' ">
				and IsReturnVist like "%"#{IsReturnVist}"%"
			</if>
			<!-- 时间条件 -->
			<if test="minHomeTime !=null and minHomeTime !='' ">
				and HomeTime &gt;= #{minHomeTime} 
			</if>
			<if test="maxHomeTime !=null and maxHomeTime !=''">
				and HomeTime &lt;= #{maxHomeTime}
			</if>
			<if test="minPayTime !=null and minPayTime !='' ">
				and PayTime &gt;= #{minPayTime} 
			</if>
			<if test="maxPayTime !=null and maxPayTime !=''">
				and PayTime &lt;= #{maxPayTime}
			</if>
			<if test="minInClassTime !=null and minInClassTime !='' ">
				and InClassTime &gt;= #{minInClassTime} 
			</if>
			<if test="maxInClassTime !=null and maxInClassTime !=''">
				and InClassTime &lt;= #{maxInClassTime}
			</if>
			<if test="minFirstVisitTime !=null and minFirstVisitTime !='' ">
				and FirstVisitTime &gt;= #{minFirstVisitTime} 
			</if>
			<if test="maxFirstVisitTime !=null and maxFirstVisitTime !=''">
				and FirstVisitTime &lt;= #{maxFirstVisitTime}
			</if>
			<if test="minCreateTime !=null and minCreateTime !='' ">
				and CreateTime &gt;= #{minCreateTime} 
			</if>
			<if test="maxCreateTime !=null and maxCreateTime !=''">
				and CreateTime &lt;= #{maxCreateTime}
			</if>
			<if test="IsValid !=null and IsValid !='' ">
				and IsValid like "%"#{IsValid}"%"
			</if>
			and s.AskerId=a.askerId
		</where>
			limit #{page},#{pagesize}
		</select>
		
		
		<select id="selectCountStu" parameterType="com.ysd.entity.hpy.Fenye" resultType="int">
			SELECT count(s.id) from students s,askers a
		<where>
			<if test="Name !=null and Name!=''">
			  and	Name like "%"#{Name}"%"
			</if>
			<if test="Phone !=null and Phone!='' ">
				and Phone like "%"#{Phone}"%"
			</if>
			<if test="IsPay !=null and IsPay !='' ">
				and IsPay like "%"#{IsPay}"%"
			</if>
			<if test="QQ !=null and QQ !='' ">
				and QQ like "%"#{QQ}"%"
			</if>
			<if test="IsReturnVist !=null and IsReturnVist !='' ">
				and IsReturnVist like "%"#{IsReturnVist}"%"
			</if>
			<!-- 时间条件 -->
			<if test="minHomeTime !=null and minHomeTime !='' ">
				and HomeTime &gt;= #{minHomeTime} 
			</if>
			<if test="maxHomeTime !=null and maxHomeTime !=''">
				and HomeTime &lt;= #{maxHomeTime}
			</if>
			<if test="minPayTime !=null and minPayTime !='' ">
				and PayTime &gt;= #{minPayTime} 
			</if>
			<if test="maxPayTime !=null and maxPayTime !=''">
				and PayTime &lt;= #{maxPayTime}
			</if>
			<if test="minInClassTime !=null and minInClassTime !='' ">
				and InClassTime &gt;= #{minInClassTime} 
			</if>
			<if test="maxInClassTime !=null and maxInClassTime !=''">
				and InClassTime &lt;= #{maxInClassTime}
			</if>
			<if test="minFirstVisitTime !=null and minFirstVisitTime !='' ">
				and FirstVisitTime &gt;= #{minFirstVisitTime} 
			</if>
			<if test="maxFirstVisitTime !=null and maxFirstVisitTime !=''">
				and FirstVisitTime &lt;= #{maxFirstVisitTime}
			</if>
			<if test="minCreateTime !=null and minCreateTime !='' ">
				and CreateTime &gt;= #{minCreateTime} 
			</if>
			<if test="maxCreateTime !=null and maxCreateTime !=''">
				and CreateTime &lt;= #{maxCreateTime}
			</if>
			<if test="IsValid !=null and IsValid !='' ">
				and IsValid like "%"#{IsValid}"%"
			</if>
			and s.AskerId=a.askerId
		</where>
		</select>
		<update id="UpdateStu" parameterType="com.ysd.entity.hpy.CustomerStudents">
			UPDATE students 
			<set>
			<if test="Name != '' and Name != null">
				Name = #{Name},
			</if>
			<if test="LearnForward != '' and LearnForward != null">
				LearnForward = #{LearnForward},
			</if>
			<if test="LostValid != '' and LostValid != null">
				LostValid = #{LostValid},
			</if>
			<if test="FirstVisitTime != '' and FirstVisitTime != null">
				FirstVisitTime = #{FirstVisitTime},
			</if>
			<if test="HomeTime != '' and HomeTime != null">
				HomeTime = #{HomeTime},
			</if>
			<if test="PayTime != '' and PayTime != null">
				PayTime = #{PayTime},
			</if>
			<if test="PreMoney != '' and PreMoney != null">
				PreMoney= #{PreMoney},
			</if>
			<if test="PreMoneyTime != '' and PreMoneyTime != null">
				PreMoneyTime = #{PreMoneyTime},
			</if>
			<if test="Money!= '' and Money!= null">
				Money = #{Money},
			</if>
			<if test="InClassTime != '' and InClassTime!= null">
				InClassTime = #{InClassTime},
			</if>
			<if test="InClassContent!= '' and InClassContent != null">
				InClassContent = #{InClassContent},
			</if>
			<if test="AskerContent != '' and AskerContent != null">
				AskerContent = #{AskerContent},
			</if>
			<if test="IsPay >=0">
				IsPay = #{IsPay},
			</if>
			<if test="IsValid >=0">
				IsValid = #{IsValid},
			</if>
			<if test="IsHome >=0">
				IsHome = #{IsHome},
			</if>
			<if test="IsReturnVist >=0">
				IsReturnVist = #{IsReturnVist},
			</if>
			<if test="IsReturnMoney >=0">
				IsReturnMoney = #{IsReturnMoney},
			</if>
			<if test="IsInClass >=0">
				IsInClass = #{IsInClass},
			</if>
		</set>
		where Id = #{Id}
		</update>
		
		<insert id="insertNetfollows" parameterType="com.ysd.entity.hpy.Netfollows">
				INSERT INTO netfollows (StudentId, StudentName, FollowTime, NextFollowTime, Content, UserId, FollowType, CreateTime, FollowState,Remarks)
				VALUES
<<<<<<< HEAD
					(#{StudentId},#{StudentName},#{FollowTime},#{NextFollowTime},#{Content},#{UserId},#{FollowType},#{CreateTime},#{FollowState},#{Remarks}) 
=======
					(#{StudentId},#{StudentName},#{FollowTime},#{NextFollowTime},#{Content},#{UserId},#{FollowType},#{CreateTime},#{1},#{Remarks}) 
>>>>>>> parent of e951112... 1
		</insert>
		<select id="selectNetfollows" parameterType="com.ysd.entity.hpy.Netfollows" resultType="com.ysd.entity.hpy.Netfollows">
			select * from netfollows where StudentId=#{StudentId}
		</select>
</mapper>